# 📁 공유 폴더 설정 가이드

## ⚠️ 중요: "편집자" 권한 설정 필수!

Google Drive에서 "링크가 있는 사용자에게 모두 허용"은 기본적으로 **읽기 권한**만 줍니다.
API를 통해 파일을 업로드하려면 **"편집자"** 권한이 필요합니다!

## 🔧 설정 방법

### 1️⃣ Google Drive에서 폴더 설정 변경

1. **Google Drive 접속**
   - https://drive.google.com/

2. **TeamCodeBridge 폴더 찾기**
   - 폴더 링크: https://drive.google.com/drive/folders/1tZGBH3CXom6Hj7p5EyjKqDrzi-O4v99I

3. **공유 설정 열기**
   - 폴더 우클릭 → "공유" 클릭
   - 또는 폴더 선택 후 상단의 공유 아이콘 클릭

4. **일반 액세스 권한 변경**
   - "일반 액세스" 섹션 찾기
   - 현재: "링크가 있는 모든 사용자" - **"뷰어"** 또는 **"댓글 작성자"**
   - 변경: "링크가 있는 모든 사용자" - **"편집자"** ✅

5. **저장**
   - "완료" 버튼 클릭

### 2️⃣ 설정 확인

올바른 설정:
```
일반 액세스: 링크가 있는 모든 사용자
역할: 편집자 ✅
```

잘못된 설정:
```
일반 액세스: 링크가 있는 모든 사용자
역할: 뷰어 ❌
역할: 댓글 작성자 ❌
```

## 📸 스크린샷 가이드

### 올바른 설정 화면:

```
┌─────────────────────────────────────┐
│  일반 액세스                            │
│                                     │
│  🔗 링크가 있는 모든 사용자              │
│     [편집자 ▼]  ← 이것이 중요!          │
│                                     │
│  [완료]                              │
└─────────────────────────────────────┘
```

## 🎯 코드에서의 작동 방식

수정된 코드는 다음과 같이 작동합니다:

1. **파일 업로드 시도**
   - 공유 폴더 ID: `1tZGBH3CXom6Hj7p5EyjKqDrzi-O4v99I`

2. **권한 확인**
   - Google Drive API로 폴더의 `capabilities.canAddChildren` 확인
   - "편집자" 권한이 있으면 `true` 반환

3. **업로드 진행**
   - 권한이 있으면: 파일 업로드 성공 ✅
   - 권한이 없으면: 에러 메시지 표시 ❌

## 🚨 문제 해결

### 에러: "공유 폴더에 쓰기 권한이 없습니다"

**원인**: 폴더가 "뷰어" 또는 "댓글 작성자" 권한으로 설정됨

**해결**:
1. Google Drive에서 폴더 공유 설정 열기
2. "링크가 있는 모든 사용자" 옆의 드롭다운 클릭
3. **"편집자"** 선택
4. "완료" 클릭

### 에러: "File not found: ."

**원인**: 폴더 ID가 잘못되었거나 폴더가 삭제됨

**해결**:
1. 폴더 링크 확인: https://drive.google.com/drive/folders/1tZGBH3CXom6Hj7p5EyjKqDrzi-O4v99I
2. 링크에서 폴더 ID 확인 (위 예시: `1tZGBH3CXom6Hj7p5EyjKqDrzi-O4v99I`)
3. `.env.local`의 `NEXT_PUBLIC_DRIVE_FOLDER_ID` 값 확인

## 🔐 보안 참고사항

**"편집자" 권한을 주면 누구나 업로드 가능한가요?**

- **아니요!** 우리 시스템은 **로그인한 멘토만** 업로드할 수 있습니다.
- Google OAuth로 인증된 사용자만 `accessToken`을 받습니다.
- 공개 링크를 알아도 시스템을 통하지 않으면 업로드 불가능합니다.

**추가 보안 조치**:
- 파일 크기 제한: 100MB
- 파일 타입 검증
- 서버 사이드 검증
- 로그인 사용자만 API 접근 가능

## ✅ 설정 완료 체크리스트

- [ ] Google Drive에서 폴더 공유 설정 열기
- [ ] "링크가 있는 모든 사용자" - "편집자" 선택
- [ ] "완료" 클릭
- [ ] 설정 저장 확인
- [ ] 웹사이트에서 로그아웃 → 재로그인
- [ ] 파일 업로드 테스트

## 📞 도움이 필요하면?

설정이 어려우면:
1. 이 문서의 스크린샷 참고
2. Google 공식 문서: https://support.google.com/drive/answer/2494822
3. 폴더 소유자에게 "편집자" 권한 요청

---

**중요**: 이 설정은 **폴더 소유자만** 변경할 수 있습니다!

